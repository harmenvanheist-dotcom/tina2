<!DOCTYPE html><html lang="nl"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tina 2</title>
<style>html,body,#chat{height:100%}body{margin:0;display:grid;place-items:center;font-family:sans-serif}</style>
<script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js" async></script>
</head><body>
<div id="chat">Ladenâ€¦</div>
<script>
(async () => {
  // wacht tot window.chatkit of window.ChatKit beschikbaar is
  const getLib = () => window.chatkit || window.ChatKit || null;
  for (let i=0;i<50 && !getLib();i++) await new Promise(r=>setTimeout(r,200));
  const lib = getLib();
  if (!lib) { document.getElementById('chat').textContent = 'Fout: ChatKit niet geladen'; return; }

  try {
    const r = await fetch("/.netlify/functions/chatkit-session", { method: "POST" });
    if (!r.ok) throw new Error("session " + r.status);
    const { client_secret } = await r.json();

    const control = await lib.createControl({
      api: { getClientSecret: async () => client_secret },
      audio: { input: true, output: true }
    });

    lib.mount(document.getElementById("chat"), { control, widget: "mini-chat-audio" });
  } catch (e) {
    document.getElementById('chat').textContent = 'Fout: ' + e.message;
  }
})();
</script>
</body></html>
